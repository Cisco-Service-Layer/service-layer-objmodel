<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <!-- For Mobile Devices -->
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
        <meta name="generator" content="Doxygen 1.8.11"/>
<meta charset="utf-8">
<!-- begin SEO -->
<title>            Blogs and Events      IOS XR Documentation @xrdocs      </title>
<meta property="og:locale" content="en-US">
<meta property="og:site_name" content="IOS XR Documentation @xrdocs">
<meta property="og:title" content="Blogs and Events">
  <link rel="canonical" href="https://xrdocs.github.io/cisco-service-layer/apidocs/">
  <meta property="og:url" content="/cisco-service-layer/apidocs/">
  <meta name="twitter:site" content="@xrdocs">
  <meta name="twitter:title" content="Blogs and Events">
  <meta name="twitter:description" content="Documentation, Blogs and Tutorials on the IOS-XR software">
  <meta name="twitter:url" content="https://xrdocs.github.io/cisco-service-layer/apidocs/">
    <meta name="twitter:card" content="summary">
      <meta name="twitter:image" content="https://xrdocs.github.io/cisco-service-layer/images/service-layer-icon-xrdocs.png">
    <meta name="twitter:creator" content="@xrdocs">
  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "Organization",
      "url": "https://xrdocs.github.io/cisco-service-layer",
      "logo": "https://xrdocs.github.io/images/service-layer-icon-xrdocs.png"
    }
  </script>
  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "person",
      "name" : "Cisco Systems Inc",
      "url" : "https://xrdocs.github.io/cisco-service-layer",
      "sameAs" : ["https://twitter.com/xrdocs"]
    }
  </script>
<!-- end SEO -->
<link href="https://xrdocs.github.io/cisco-service-layer/feed.xml" type="application/atom+xml" rel="alternate" title="IOS XR Documentation @xrdocs Feed">
<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="google-site-verification" content="jgRKKm6B9FwJJPXxpmc0-EP3D0Mh8JHXaJqoYIGj1ek" />
<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>
<script>
if (!(window.location.host.startsWith("127.0.0.1") || window.location.host.startsWith("localhost")) && (window.location.host.substr(-10) == '.github.io') && (window.location.protocol != "https:"))
    window.location.protocol = "https";
</script>
<!-- For all browsers -->
        <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
        <link href="doxyboot.css" rel="stylesheet" type="text/css"/>
<link rel="stylesheet" href="/assets/css/main.css">
<meta http-equiv="cleartype" content="on">
<style>
.underline-on-hover:hover {
    text-decoration: underline;
}
.searchForm{
      border-radius:5px;
      -moz-border-radius:5px;
      -webkit-border-radius:5px;
      width: 900px;
   }
#search_results{
      display: table; margin:0 auto;
   }
</style>
</style>
<!-- start custom head snippets -->
<link href="https://xrdocs.github.io/cisco-service-layer/assets/css/lity.min.css" rel="stylesheet">
<link href="https://xrdocs.github.io/cisco-service-layer/css/cisco-sans.min.css" rel="stylesheet">
<link href="https://xrdocs.github.io/cisco-service-layer/assets/css/material-scrolltop.css" rel="stylesheet">
<link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://xrdocs.github.io/cisco-service-layer/images/apple-touch-icon-57x57.png" />
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://xrdocs.github.io/cisco-service-layer/images/apple-touch-icon-114x114.png" />
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://xrdocs.github.io/cisco-service-layer/images/apple-touch-icon-72x72.png" />
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://xrdocs.github.io/cisco-service-layer/images/apple-touch-icon-144x144.png" />
<link rel="apple-touch-icon-precomposed" sizes="60x60" href="https://xrdocs.github.io/cisco-service-layer/images/apple-touch-icon-60x60.png" />
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://xrdocs.github.io/cisco-service-layer/images/apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://xrdocs.github.io/cisco-service-layer/images/apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://xrdocs.github.io/cisco-service-layer/images/apple-touch-icon-152x152.png" />
<link rel="icon" type="image/png" href="https://xrdocs.github.io/cisco-service-layer/images/favicon-196x196.png" sizes="196x196" />
<link rel="icon" type="image/png" href="https://xrdocs.github.io/cisco-service-layer/images/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/png" href="https://xrdocs.github.io/cisco-service-layer/images/favicon-32x32.png" sizes="32x32" />
<link rel="icon" type="image/png" href="https://xrdocs.github.io/cisco-service-layer/images/favicon-16x16.png" sizes="16x16" />
<link rel="icon" type="image/png" href="https://xrdocs.github.io/cisco-service-layer/images/favicon-128.png" sizes="128x128" />
<link rel="shortcut icon" href="https://xrdocs.github.io/cisco-service-layer/images/favicon_cisco.ico" />
<meta name="application-name" content="&nbsp;"/>
<meta name="msapplication-TileColor" content="#FFFFFF" />
<meta name="msapplication-TileImage" content="https://xrdocs.github.io/cisco-service-layer/images/mstile-144x144.png" />
<meta name="msapplication-square70x70logo" content="https://xrdocs.github.io/cisco-service-layer/images/mstile-70x70.png" />
<meta name="msapplication-square150x150logo" content="https://xrdocs.github.io/cisco-service-layer/images/mstile-150x150.png" />
<meta name="msapplication-wide310x150logo" content="https://xrdocs.github.io/cisco-service-layer/images/mstile-310x150.png" />
<meta name="msapplication-square310x310logo" content="https://xrdocs.github.io/cisco-service-layer/images/mstile-310x310.png" />
<!-- end custom head snippets -->
        <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
        <script type="text/javascript" src="dynsections.js"></script>
        <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="doxy-boot.js"></script>
    </head>
<body style="overflow-x: visible;">
<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu" style="padding-left: 0;">
      <nav id="site-nav" class="greedy-nav">
        <button><div class="navicon"></div></button>
        <ul class="visible-links">
          <img src="https://xrdocs.github.io/images/xrdocs_logo.png" width="45px" height="45px" alt="xrdocs logo" style="float:left;">
          <li class="masthead__menu-item masthead__menu-item--lg"><a href="https://xrdocs.github.io/">@xrdocs</a></li>
          <li class="masthead__menu-item masthead__menu-item"><a href="https://xrdocs.github.io/cisco-service-layer/">Cisco Service Layer</a></li>
                    <li class="masthead__menu-item greedy-nav-active"><a href="https://xrdocs.github.io/cisco-service-layer/apidocs/">Apidocs</a></li>
                    <li class="masthead__menu-item"><a href="https://xrdocs.github.io/cisco-service-layer/blogs/">Blogs</a></li>
                    <li class="masthead__menu-item"><a href="https://xrdocs.github.io/cisco-service-layer/tutorials/">Tutorials</a></li>
                    <li class="masthead__menu-item"><a href="https://xrdocs.github.io/cisco-service-layer/search">Search <i class="fa fa-search" aria-hidden="true"></i></a></li>
                    <li class="masthead__menu-item"><a href="https://xrdocs.github.io/cisco-service-layer/tags/">Tags</a></li>
                    <li class="masthead__menu-item"><a href="https://xrdocs.github.io/cisco-service-layer/collection-archive/">Archive</a></li>
        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>
        <div id="top" style="font-size:0.75em;margin-top:2em; padding-left:2em; padding-right:2em;"><!-- do not remove this div, it is closed by doxygen! -->
            <div class="content" id="content" style="border-bottom:5px solid #eee;">
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Quick&#160;Start</span></a></li>
      <li><a href="modules.html"><span>Services</span></a></li>
      <li><a href="annotated.html"><span>Messages</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Cisco Service Layer API Documentation</div>  </div>
</div><!--header-->
<h2>Python Quick Tutorial</h2>
<h3>Table of Contents</h3>
<ul>
<li><a href="#server">Server Setup</a></li>
<li><a href="#quick">Running the tutorial</a></li>
<li><a href="#gen">Generate gRPC Code</a></li>
<li><a href="#init">Initialize the client server connection</a></li>
<li><a href="#vrf">Register the VRF</a></li>
<li><a href="#route">Add a Batch of Routes</a></li>
</ul>
<h4><a class="anchor" id="server"></a>Server Setup</h4>
<p>On the server side, we need to configure GRPC and enable the service layer through the following CLI configuration: </p><pre class="fragment">! Configure GRPC
configure
grpc port 57344
grpc address-family ipv4
commit
end

! Configure Service layer
configure
grpc service-layer
commit
end
</pre><p>We also need to configure a server IP address. To configure an IP address on the managment interface, one can use dhcp as follows: </p><pre class="fragment">! Configure the Mgmt Interface
configure
interface MgmtEth 0/RP0/CPU0/0
ipv4 address dhcp
no shut
commit
end
</pre><p>To check the IP address assigned: </p><pre class="fragment">show ip interface brief
</pre><p>On the client side, the very first thing we need to do is set the server IP address and gRPC port. You can check your port number by running the following CLI command on the IOS-XR server box (should be the same as the one configured): </p><pre class="fragment"># show run grpc
</pre><p>Set the server address and port number as environment variables with the following example command (this is assuming you are in bash shell): </p><pre class="fragment">$ export SERVER_IP=192.168.122.192
$ export SERVER_PORT=57344
</pre><p>The above assumes that the IP address of the node is 192.168.122.192.</p>
<p>This completes all the setup needed to start writing some code! Hop into your python interpreter and try out some of the commands to get familiar with the API.</p>
<h2><a class="anchor" id="quick"></a>Running the tutorial</h2>
<p>The following basic tutorial will walk you through getting started with the Service Layer API, in particular on how to add a route. This may require some initial python and GRPC setup, which will be explained below. For now, if you already have passed this setup step, run the example: </p><pre class="fragment">cd grpc/python/src
python tutorial/quickstart.py
</pre><p>The following sections explain the details of the above example tutorial.</p>
<h4><a class="anchor" id="gen"></a>Generate gRPC Code (optional in this example)</h4>
<p>If you are not familiar with gRPC, we recommend you refer to gRPC's documentation before beginning with our tutorial: <a href="http://www.grpc.io/docs/">gRPC Docs</a></p>
<p>You should have received all of the protobuf files required to run the Cisco Service Laye API. In order to generate the gRPC client side code stubs in python, run the following command (you may have to adjust the path to the proto files and the output according to your requirements):</p>
<p><b>For convenience, these files are also committed in this repo under grpc/python/src/genpy/ (so you can skip this step).</b> </p><pre class="fragment">$ protoc -I ../../protos --python_out=. --grpc_out=./genpy/ --plugin=protoc-gen-grpc=`which grpc_python_plugin` ../../protos/*.proto
</pre><p>This generates the code stubs that we will now utilize to create a client. The files are recognizable from the "_pb2" that is appended to the name of the proto files they were generated from (example: sl_route_ipv4_pb2.py).</p>
<h4><a class="anchor" id="init"></a>Initialize the client server connection</h4>
<p>In order to follow this quick tutorial, it is best to open the files in <code>grpc/python/src/tutorial/</code> </p><pre class="fragment">quickstart.py  : The full tutorial example
client_init.py : Used to setup the client-server connection
vrf.py         : Used to setup the Route vertical
</pre><p>As shown in quickstart.py, the first thing to do is to setup the GRPC channel: </p><pre class="fragment">server_ip, server_port = util.get_server_ip_port()
channel = implementations.insecure_channel(server_ip, server_port)
</pre><p>Once connected, we need to handshake the API version number with the server. The same RPC call also sets up an asynchronous stream of notifications from the server. The first notification would be the response to our version number message i.e. <a class="el" href="group__SLGlobal.html#structSLInitMsg" title="Initialization message sent to the server. ">SLInitMsg</a>, as a <a class="el" href="group__SLGlobal.html#structSLGlobalNotif" title="Globals query message. ">SLGlobalNotif</a> event with type SL_GLOBAL_EVENT_TYPE_VERSION. This can be done by calling: </p><pre class="fragment">SLGlobalInitNotif(init_msg, Timeout)
</pre><p>The above function takes the client major, minor and sub version numbers and sends them to the Service Layer service to get a handshake on the API version number. More on this below.</p>
<p>The following code snippets are copied from file client_init.py </p><pre class="fragment">def client_init(stub, event):
    #
    # Create SLInitMsg to handshake the version number with the server.
    # The Server will allow/deny access based on the version number.
    # The same RPC is used to setup a notification channel for global
    # events coming from the server.
    #
    # # Set the client version number based on the current proto files' version
    init_msg = sl_global_pb2.SLInitMsg()
    init_msg.MajorVer = sl_version_pb2.SL_MAJOR_VERSION
    init_msg.MinorVer = sl_version_pb2.SL_MINOR_VERSION
    init_msg.SubVer = sl_version_pb2.SL_SUB_VERSION

    # Set a very large timeout, as we will "for ever" loop listening on
    # notifications from the server
    Timeout = 365*24*60*60 # Seconds

    # This for loop will never end unless the server closes the session
    for response in stub.SLGlobalInitNotif(init_msg, Timeout):
        if response.EventType == sl_global_pb2.SL_GLOBAL_EVENT_TYPE_VERSION:
            if (sl_common_types_pb2.SLErrorStatus.SL_SUCCESS ==
                    response.ErrStatus.Status):
</pre><p>The above python definition also handles other events such as errors and heartbeats. Notice that the client_init definition above takes a GRPC stub as an argument. This is typically created through: </p><pre class="fragment"># Create the gRPC stub.
stub = sl_global_pb2.beta_create_SLGlobal_stub(channel)
</pre><p>Since the above client_init function would never return, it is best to spawn it as a thread, and run it in the background. In python, we do so by calling a threading event: </p><pre class="fragment">#
# Spawn a thread for global events
#
def global_init(channel):
    # Create the gRPC stub.
    stub = sl_global_pb2.beta_create_SLGlobal_stub(channel)

    # Create a thread sync event. This will be used to order thread execution
    event = threading.Event()

    # The main reason we spawn a thread here, is that we dedicate a GRPC
    # channel to listen on Global asynchronous events/notifications.
    # This thread will be handling these event notifications.
    t = threading.Thread(target = global_thread, args=(stub, event))
    t.start()
</pre><h4><a class="anchor" id="vrf"></a>Register the VRF</h4>
<p>In general, before we can use a vertical function like the route APIs, we have to register on that vertical. The route API allows the user to register based on a per VRF basis. So, before any additions or modification of routes can be made we need to register with the proper VRF, which requires sending a VRF registration message and then an EOF message to clean up any stale routes that may be there from an older configuration (this will become handy on restart or recovery scenarios).</p>
<p>The following snippets are copied from file vrf.py</p>
<p>Next up, create the stub instance using the channel. This stub will have the exact same methods that are available on the server. To do this, we need to import the stub code generated from our ProtoBuf files. Depending on what calls you want to make, different stubs will be used. We are going to be making changes to our IPv4 routes, so we use the SLRoutev4Oper_stub. </p><pre class="fragment">from genpy import sl_route_ipv4_pb2
stub = sl_route_ipv4_pb2.beta_create_SLRoutev4Oper_stub(channel)
</pre><p>Time to fill in some variables!</p>
<p>Create the <code><a class="el" href="group__SLRouteCommon.html#structSLVrfRegMsg" title="VRF Registration messages. ">SLVrfRegMsg</a></code> object. Generating a <code><a class="el" href="group__SLRouteCommon.html#structSLVrfRegMsg" title="VRF Registration messages. ">SLVrfRegMsg</a></code> object allows us to use dot notation to access and set it's variables. </p><pre class="fragment">from genpy import sl_route_common_pb2
vrfMsg = sl_route_common_pb2.SLVrfRegMsg()
</pre><p>The VRF registration message contains a set of VRF registration objects.</p>
<p>Create an <code><a class="el" href="group__SLRouteCommon.html#structSLVrfReg" title="VRF Registration message. ">SLVrfReg</a></code> object. </p><pre class="fragment">vrfObj = sl_route_common_pb2.SLVrfReg()
</pre><p>Set the VRF registration object attributes:</p>
<p>VRF name. The default VRF in IOS-XR is called "default": </p><pre class="fragment">vrfObj.VrfName = 'default'
</pre><p>Administrative distance. The admin distance is used by RIB to make best path decisions. </p><pre class="fragment">vrfObj.AdminDistance = 2
</pre><p>VRF purge interval. This is useful on restart scenarios. </p><pre class="fragment">vrfObj.VrfPurgeIntervalSeconds = 500
</pre><p>Add the registration message to the list. In the case of a bulk object, we can append other VRF objects to the list. </p><pre class="fragment">vrfList.append(vrfObj)
</pre><p>Now that the list is completed, assign <code>vrf_list</code> to the <code><a class="el" href="group__SLRouteCommon.html#structSLVrfRegMsg" title="VRF Registration messages. ">SLVrfRegMsg</a></code>. </p><pre class="fragment">vrfMsg.VrfRegMsgs.extend(vrfList)
</pre><p>Make the RPC call.</p>
<p>We are ready to make our call to the API. We'll send the <code><a class="el" href="group__SLRouteCommon.html#structSLVrfRegMsg" title="VRF Registration messages. ">SLVrfRegMsg</a> vrfMsg</code> and a timeout interval (in seconds) for the gRPC server. </p><pre class="fragment">Timeout = 10 # Seconds
response = stub.SLRoutev4VrfRegOp(vrfMsg, Timeout)
</pre><p>Note that the vrfMsg has an Oper field that determines the operation type: </p><pre class="fragment">SL_REGOP_REGISTER  : used for registrations
SL_REGOP_EOF       : used for EOF signaling. Useful for restart scenarios
SL_REGOP_UNREGISTER: used to unregister, which would clean all previous roues added in that VRF.
</pre><p>Finally, we can print our response from the server. Notice that, since we can add a batch of VRF registrations, we want to print a result code for each individual response. To do this, we check if the response is an error, and if it is we print the name of the vrf that caused the error as well as the hexadecimal error code. </p><pre class="fragment">if (response.StatusSummary.Status ==
        sl_common_types_pb2.SLErrorStatus.SL_SUCCESS):
    print "VRF %s Success!" %(
        sl_common_types_pb2.SLRegOp.keys()[oper])
else:
    print "Error code for VRF %s is 0x%x! Response:" % (
        sl_common_types_pb2.SLRegOp.keys()[oper],
        response.StatusSummary.Status
    )
    print response
    # If we have partial failures within the batch, let's print them
    if (response.StatusSummary.Status == 
        sl_common_types_pb2.SLErrorStatus.SL_SOME_ERR):
        for result in response.Results:
            print "Error code for %s is 0x%x" %(result.VrfName,
                result.ErrStatus.Status
            )
</pre><h4><a class="anchor" id="route"></a>Add a Batch of Routes</h4>
<p>Now that we have registered the VRF, we can start adding routes. We will show adding a batch of 10 routes to the RIB.</p>
<p>Create an empty list of routes. </p><pre class="fragment">routeList = []
</pre><p>Create a <code><a class="el" href="group__SLRouteIPv4Oper.html#structSLRoutev4Msg" title="List of routes for bulk download. ">SLRoutev4Msg</a></code> message. </p><pre class="fragment">rtMsg = sl_route_ipv4_pb2.SLRoutev4Msg()
</pre><p>Fill in the route attributes.</p>
<p>VRF Name </p><pre class="fragment">rtMsg.VrfName = 'default'
</pre><p>Add a loop that will add 10 incrementing routes to the RIB table. </p><pre class="fragment">for i in range(10):
</pre><p>Create a <code><a class="el" href="group__SLRouteIPv4Oper.html#structSLRoutev4" title="IPv4 route. ">SLRoutev4</a></code> object. </p><pre class="fragment">    route = sl_route_ipv4_pb2.SLRoutev4()
</pre><p>IP address import ipaddress route.Prefix = ( int(ipaddress.ip_address('20.0.'+ str(i) + '.0')) )</p>
<p>Prefix Length </p><pre class="fragment">    route.PrefixLen = 24
</pre><p>Administrative distance (this can override the VRF registration admin distance) </p><pre class="fragment">    route.RouteCommon.AdminDistance = 2
</pre><p>Set the route's paths.</p>
<p>A route may have one or many paths. Create an empty list of paths as a placeholder for these paths. </p><pre class="fragment">    paths = []
</pre><p>Create an <code><a class="el" href="group__SLRouteCommon.html#structSLRoutePath" title="Route Path attributes. ">SLRoutePath</a></code> object. </p><pre class="fragment">    path = sl_route_common_pb2.SLRoutePath()
</pre><p>Fill in the path attributes. Note: if you are deleting a route, paths are not required to be added, so it is better not to fill in this part for a delete.</p>
<p>Path next hop address </p><pre class="fragment">    path.NexthopAddress.V4Address = (
        int(ipaddress.ip_address('10.10.10.1'))
    )
</pre><p>Next hop interface name </p><pre class="fragment">    path.NexthopInterface.Name = 'GigabitEthernet0/0/0/0'
</pre><p>Add the path to the list </p><pre class="fragment">    paths.append(path)
</pre><p>Let's create another path as equal cost multi-path (ECMP) </p><pre class="fragment">    path = sl_route_common_pb2.SLRoutePath()
    path.NexthopAddress.V4Address = (
        int(ipaddress.ip_address('10.10.10.2'))
    )
    path.NexthopInterface.Name = 'GigabitEthernet0/0/0/0'
    paths.append(path)
</pre><p>Add the paths to the route object. In the example quickstart.py tutorial, we add a line checking that the operation is not a delete operation, as we would not need to add paths for a delete. </p><pre class="fragment">    if oper != sl_common_types_pb2.SL_OBJOP_DELETE:
        route.PathList.extend(paths)
</pre><p>Add the route to <code>route_list</code> (bulk routes) </p><pre class="fragment">    routeList.append(route)
</pre><p>Assign the <code>routeList</code> to the <code>rtMsg</code>. </p><pre class="fragment">rtMsg.Routes.extend(routeList)
</pre><p>Make the RPC call. </p><pre class="fragment">Timeout = 10 # Seconds
rtMsg.Oper = oper # Desired ADD, UPDATE, DELETE operation
response = stub.SLRoutev4Op(rtMsg, Timeout)
</pre><p>Again, in the quickstart.py tutorial we have examples of other route calls beyond just adding bulk routes. </p><pre class="fragment"># RPC route operations
#    for add: sl_common_types_pb2.SL_OBJOP_ADD
#    for update: sl_common_types_pb2.SL_OBJOP_UPDATE
#    for delete: sl_common_types_pb2.SL_OBJOP_DELETE
route_operation(channel, sl_common_types_pb2.SL_OBJOP_ADD)
</pre><p>These calls show examples of bulk additions, updates, and deletes</p>
<p>Check the server's response. Here again we can check each individual route that was added for an error message. </p><pre class="fragment">if (sl_common_types_pb2.SLErrorStatus.SL_SUCCESS == 
        response.StatusSummary.Status):
    print "Route %s Success!" %(
        sl_common_types_pb2.SLObjectOp.keys()[oper])
else:
    print "Error code for route %s is 0x%x" % (
        sl_common_types_pb2.SLObjectOp.keys()[oper],
        response.StatusSummary.Status
    )
    # If we have partial failures within the batch, let's print them
    if (response.StatusSummary.Status == 
        sl_common_types_pb2.SLErrorStatus.SL_SOME_ERR):
        for result in response.Results:
            print "Error code for %s/%d is 0x%x" %(
                str(ipaddress.ip_address(result.Prefix)),
                result.PrefixLen,
                result.ErrStatus.Status
            )
</pre><p>That's all for now! Remember some key takeaways:</p>
<ol type="1">
<li>The VRF must be registered before adding, updating, or removing routes from the RIB.</li>
<li>All API operations are CRUD based (Create, Read, Update, Delete), and the initial setup of all calls to the same object will be (about) the same. </li>
</ol>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
    <div class="page__footer" style="position: relative;">
      <footer>
<div class="page__footer-follow">
  <ul class="social-icons">
      <li><strong>Follow:</strong></li>
      <li><a href="https://twitter.com/xrdocs"><i class="fa fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
      <li><a href="http://github.com/xrdocs"><i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
    <li><a href="https://xrdocs.github.io/cisco-service-layer/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>
<div class="page__footer-copyright">&copy; 2017 Cisco Systems Inc. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>
      </footer>
    </div>
    <script src="https://xrdocs.github.io/cisco-service-layer/assets/js/main.min.js"></script>
<script src="https://xrdocs.github.io/cisco-service-layer/assets/js/scrollmenu.js"></script>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-78256516-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- material-scrolltop button -->
<button class="material-scrolltop" type="button"></button>
<!-- material-scrolltop plugin -->
<script src="https://xrdocs.github.io/cisco-service-layer/assets/js/material-scrolltop.js"></script>
<!-- Initialize material-scrolltop with (minimal) -->
<script>
    $('body').materialScrollTop();
</script>
</body>
</html>
